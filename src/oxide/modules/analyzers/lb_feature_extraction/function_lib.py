# Functions in the C library that check system or user inputs
system_input_checks = [
    "assert",
    "atexit",
    "catgets6",
    "catopen6",
    "clock",
    "fdopen5",
    "fgetc1",
    "fgets1",
    "fgetwc6",
    "fgetws6",
    "fileno5",
    "fopen",
    "fread",
    "freopen",
    "fscanf",
    "ftell1",
    "fwide6",
    "fwscanf6",
    "getc1",
    "getchar1",
    "getenv",
    "gets",
    "getwc6",
    "getwchar6",
    "mbsinit4",
    "nl_langinfo4",
    "putenv",
    "rand",
    "rand_r",
    "regcomp",
    "scanf",
    "setlocale",
    "sscanf",
    "swscanf",
    "time",
    "time64",
    "vfscanf",
    "vfwscanf",
    "vscanf",
    "vsscanf",
    "vswscanf",
    "vwscanf",
    "wscanf6",
]

# Functions found to be vulnerable or perform sensitive operations
sensitive_functions = {
    "abort",
    "assert",
    "atexit",
    "atof",
    "atoi",
    "atol",
    "calloc",
    "catclose6",
    "catgets6",
    "catopen6",
    "clearerr",
    "exit",
    "fclose",
    "fdopen5",
    "fflush1",
    "fgetc1",
    "fgetpos1",
    "fgets1",
    "fileno5",
    "fopen",
    "fprintf",
    "fputc1",
    "fputs1",
    "fputwc6",
    "fputws6",
    "fread",
    "free",
    "freopen",
    "fscanf",
    "fseek1",
    "fsetpos1",
    "ftell1",
    "fwide6",
    "fwprintf6",
    "fwrite",
    "fwscanf6",
    "getc1",
    "getchar1",
    "getenv",
    "gets",
    "getwc6",
    "getwchar6",
    "iswprint4",
    "longjmp",
    "malloc",
    "nl_langinfo4",
    "perror",
    "printf",
    "putc1",
    "putchar1",
    "putenv",
    "puts",
    "putwc6",
    "putwchar6",
    "raise",
    "realloc",
    "regcomp",
    "regfree",
    "remove",
    "rename",
    "rewind1",
    "scanf",
    "setbuf",
    "setjmp",
    "setlocale",
    "setvbuf",
    "signal",
    "sprintf",
    "srand",
    "sscanf",
    "strcat",
    "strcpy",
    "strerror",
    "swprintf",
    "swscanf",
    "system",
    "tmpfile",
    "tmpnam",
    "ungetc1",
    "ungetwc6",
    "va_copy",
    "va_end",
    "va_start",
    "vfprintf",
    "vfscanf",
    "vfwprintf6",
    "vfwscanf",
    "vprintf",
    "vscanf",
    "vsprintf",
    "vsnprintf",
    "vsscanf",
    "vswprintf",
    "vswscanf",
    "vwprintf6",
    "vwscanf",
    "wcscat",
    "wcscpy",
    "wprintf6",
    "wscanf6",
}

# Functions that should be ingnored as they are generated by the compiler
functions_ignore = {
    "__libc_start_main",
    "__do_global_dtors_aux",
    "__cxa_finalize",
    "_init",
    "frame_dummy",
    "__libc_csu_init",
    "register_tm_clones",
    "deregister_tm_clones",
    "_start",
    "__stack_chk_fail",
    "puts",
    "__libc_csu_init",
    "abort",
    "abs",
    "acos",
    "asctime",
    "asctime_r",
    "asin",
    "assert",
    "atan",
    "atan2",
    "atexit",
    "atof",
    "atoi",
    "atol",
    "bsearch",
    "btowc",
    "calloc",
    "catclose6",
    "catgets6",
    "catopen6",
    "ceil",
    "clearerr",
    "clock",
    "cos",
    "cosh",
    "ctime",
    "ctime64",
    "ctime_r",
    "ctime64_r",
    "difftime",
    "difftime64",
    "div",
    "erf",
    "erfc",
    "exit",
    "exp",
    "fabs",
    "fclose",
    "fdopen5",
    "feof",
    "ferror",
    "fflush1",
    "fgetc1",
    "fgetpos1",
    "fgets1",
    "fgetwc6",
    "fgetws6",
    "fileno5",
    "floor",
    "fmod",
    "fopen",
    "fprintf",
    "fputc1",
    "fputs1",
    "fputwc6",
    "fputws6",
    "fread",
    "free",
    "freopen",
    "frexp",
    "fscanf",
    "fseek1",
    "fsetpos1",
    "ftell1",
    "fwide6",
    "fwprintf6",
    "fwrite",
    "fwscanf6",
    "gamma",
    "getc1",
    "getchar1",
    "getenv",
    "gets",
    "getwc6",
    "getwchar6",
    "gmtime",
    "gmtime64",
    "gmtime_r",
    "gmtime64_r",
    "hypot",
    "isalnum",
    "isalpha",
    "isascii4",
    "isblank",
    "iscntrl",
    "isdigit",
    "isgraph",
    "islower",
    "isprint",
    "ispunct",
    "isspace",
    "isupper",
    "iswalnum4",
    "iswalpha4",
    "iswblank4",
    "iswcntrl4",
    "iswctype4",
    "iswdigit4",
    "iswgraph4",
    "iswlower4",
    "iswprint4",
    "iswpunct4",
    "iswspace4",
    "iswupper4",
    "iswxdigit4",
    "isxdigit4",
    "j0",
    "j1",
    "jn",
    "labs",
    "ldexp",
    "ldiv",
    "localeconv",
    "localtime",
    "localtime64",
    "localtime_r",
    "localtime64_r",
    "log",
    "log10",
    "longjmp",
    "malloc",
    "mblen",
    "mbrlen4",
    "mbrtowc4",
    "mbsinit4",
    "mbsrtowcs4",
    "mbstowcs",
    "mbtowc",
    "memchr",
    "memcmp",
    "memcpy",
    "memmove",
    "memset",
    "mktime",
    "mktime64",
    "modf",
    "nextafter",
    "nextafterl",
    "nexttoward",
    "nexttowardl",
    "nl_langinfo4",
    "perror",
    "pow",
    "printf",
    "putc1",
    "putchar1",
    "putenv",
    "puts",
    "putwc6",
    "putwchar6",
    "qsort",
    "quantexpd32",
    "quantexpd64",
    "quantexpd128",
    "quantized32",
    "quantized64",
    "quantized128",
    "samequantumd32",
    "samequantumd64",
    "samequantumd128",
    "raise",
    "rand",
    "rand_r",
    "realloc",
    "regcomp",
    "regerror",
    "regexec",
    "regfree",
    "remove",
    "rename",
    "rewind1",
    "scanf",
    "setbuf",
    "setjmp",
    "setlocale",
    "setvbuf",
    "signal",
    "sin",
    "sinh",
    "snprintf",
    "sprintf",
    "sqrt",
    "srand",
    "sscanf",
    "strcasecmp",
    "strcat",
    "strchr",
    "strcmp",
    "strcoll",
    "strcpy",
    "strcspn",
    "strerror",
    "strfmon4",
    "strftime",
    "strlen",
    "strncasecmp",
    "strncat",
    "strncmp",
    "strncpy",
    "strpbrk",
    "strptime4",
    "strrchr",
    "strspn",
    "strstr",
    "strtod",
    "strtod32",
    "strtod64",
    "strtod128",
    "strtof",
    "strtok",
    "strtok_r",
    "strtol",
    "strtold",
    "strtoul",
    "strxfrm",
    "swprintf",
    "swscanf",
    "system",
    "tan",
    "tanh",
    "time",
    "time64",
    "tmpfile",
    "tmpnam",
    "toascii",
    "tolower",
    "toupper",
    "towctrans",
    "towlower4",
    "towupper4",
    "ungetc1",
    "ungetwc6",
    "va_arg",
    "va_copy",
    "va_end",
    "va_start",
    "vfprintf",
    "vfscanf",
    "vfwprintf6",
    "vfwscanf",
    "vprintf",
    "vscanf",
    "vsprintf",
    "vsnprintf",
    "vsscanf",
    "vswprintf",
    "vswscanf",
    "vwprintf6",
    "vwscanf",
    "wcrtomb4",
    "wcscat",
    "wcschr",
    "wcscmp",
    "wcscoll4",
    "wcscpy",
    "wcscspn",
    "wcsftime",
    "wcslen",
    "wcslocaleconv",
    "wcsncat",
    "wcsncmp",
    "wcsncpy",
    "wcspbrk",
    "wcsptime",
    "wcsrchr",
    "wcsrtombs4",
    "wcsspn",
    "wcsstr",
    "wcstod",
    "wcstod32",
    "wcstod64",
    "wcstod128",
    "wcstof",
    "wcstok",
    "wcstol",
    "wcstold",
    "wcstombs",
    "wcstoul",
    "wcsxfrm4",
    "wctob",
    "wctomb",
    "wctrans",
    "wctype4",
    "wcwidth",
    "wmemchr",
    "wmemcmp",
    "wmemcpy",
    "wmemmove",
    "wmemset",
    "wprintf6",
    "wscanf6",
    "y0",
    "y1",
    "yn",
}

pthread_funcs ={
    "pthread_attr_destroy",
    "pthread_attr_getdetachstate",
    "pthread_attr_getguardsize",
    "pthread_attr_getinheritsched",
    "pthread_attr_getschedparam",
    "pthread_attr_getschedpolicy",
    "pthread_attr_getscope",
    "pthread_attr_getstackaddr",
    "pthread_attr_getstacksize",
    "pthread_attr_init",
    "pthread_attr_setdetachstate",
    "pthread_attr_setguardsize",
    "pthread_attr_setinheritsched",
    "pthread_attr_setschedparam",
    "pthread_attr_setschedpolicy",
    "pthread_attr_setscope",
    "pthread_attr_setstackaddr",
    "pthread_attr_setstacksize",
    "pthread_cancel",
    "pthread_cleanup_push",
    "pthread_cleanup_pop",
    "pthread_cond_broadcast",
    "pthread_cond_destroy",
    "pthread_cond_init",
    "pthread_cond_signal",
    "pthread_cond_timedwait",
    "pthread_cond_wait",
    "pthread_condattr_destroy",
    "pthread_condattr_getpshared",
    "pthread_condattr_init",
    "pthread_condattr_setpshared",
    "pthread_create",
    "pthread_detach",
    "pthread_equal",
    "pthread_exit",
    "pthread_getconcurrency",
    "pthread_getschedparam",
    "pthread_getspecific",
    "pthread_join",
    "pthread_key_create",
    "pthread_key_delete",
    "pthread_mutex_destroy",
    "pthread_mutex_getprioceiling",
    "pthread_mutex_init",
    "pthread_mutex_lock",
    "pthread_mutex_setprioceiling",
    "pthread_mutex_trylock",
    "pthread_mutex_unlock",
    "pthread_mutex_consistent",
    "pthread_mutexattr_destroy",
    "pthread_mutexattr_getprioceiling",
    "pthread_mutexattr_getprotocol",
    "pthread_mutexattr_getpshared",
    "pthread_mutexattr_getrobust",
    "pthread_mutexattr_gettype",
    "pthread_mutexattr_init",
    "pthread_mutexattr_setprioceiling",
    "pthread_mutexattr_setprotocol",
    "pthread_mutexattr_setpshared",
    "pthread_mutexattr_setrobust",
    "pthread_mutexattr_settype",
    "pthread_once",
    "pthread_rwlock_destroy",
    "pthread_rwlock_init",
    "pthread_rwlock_rdlock",
    "pthread_rwlock_tryrdlock",
    "pthread_rwlock_trywrlock",
    "pthread_rwlock_unlock",
    "pthread_rwlock_wrlock",
    "pthread_rwlockattr_destroy",
    "pthread_rwlockattr_getpshared",
    "pthread_rwlockattr_init",
    "pthread_rwlockattr_setpshared",
    "pthread_self",
    "pthread_setcancelstate",
    "pthread_setcanceltype",
    "pthread_setconcurrency",
    "pthread_setschedparam",
    "struct sched_param",
    "pthread_setspecific",
    "pthread_testcancel"
}